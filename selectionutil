import { AppDispatch, getLovData } from "../../../services/common-service";
import { FindIndex } from "../../../utils/common/change.utils";
import { CONSTANTS } from "../../../utils/common/constants";
import { KeyWithAnyModel, RadioDependecyModel, StageDetails } from "../../../utils/model/common-model";
import { fieldErrorAction } from "../../../utils/store/field-error-slice";
import { stagesAction } from "../../../utils/store/stages-slice";


export const getFields = (getStages: Array<StageDetails>, radioResidency: RadioDependecyModel | null, userInputs: any, parentChildToggleSelector: any, removeList?: boolean): any => {
    return (dispatch: AppDispatch) => {
        let fields: Array<KeyWithAnyModel> | undefined;
        if (getStages && getStages[0].stageInfo && getStages[0].stageInfo.fieldMetaData && getStages[0].stageInfo.fieldMetaData.data.stages) {
            const stageId = getStages[0].stageId;
            const stageIndex = FindIndex(getStages[0].stageInfo, stageId);
            fields = getStages[0].stageInfo.fieldMetaData.data.stages[stageIndex].fields;
        }

        let ssfStages: Array<string> | null = null;
        let showFields: Array<string> = [];
        let removeFields: Array<string> = [];
        let showResFields: Array<string> = [];
        let removeResFields: Array<string> = [];
        let showMailFields: Array<string> = [];
        let removeMailFields: Array<string> = [];

        const removeAddToggleFieldFn = (showFields: Array<string> | null, removeFields: Array<string> | null) => {
            dispatch(fieldErrorAction.removeMandatoryFields(removeFields));
            dispatch(
                stagesAction.removeAddToggleField({
                    removeFields: removeFields,
                    newFields: showFields,
                    value: ''
                })
            );
            //During the onchange of work_type_2 these values should not get empty ''
            dispatch(stagesAction.modifyStage({fieldData: { fieldName: CONSTANTS.LOGICAL_FIELD_NAMES.NATURE_OF_EMPLOYER,
                value: userInputs.applicants[0][CONSTANTS.LOGICAL_FIELD_NAMES.NATURE_OF_EMPLOYER],} 
            }));
        }

        const updateDynamicFields = (radioResidency: RadioDependecyModel) => {
            if(radioResidency.logical_field_name === CONSTANTS.LOGICAL_FIELD_NAMES.RES_COUNTRY_1) {
                if(radioResidency.value === CONSTANTS.LOV_DATA.CHINESE_MAINLAND) {
                    dispatch(
                        stagesAction.removeAddToggleField({
                            removeFields: [CONSTANTS.LOGICAL_FIELD_NAMES.STATE_RES_1, CONSTANTS.LOGICAL_FIELD_NAMES.CITY_RES_1, CONSTANTS.LOGICAL_FIELD_NAMES.ADDRESS_RES_1, CONSTANTS.LOGICAL_FIELD_NAMES.ADDRESS_RES_2, CONSTANTS.LOGICAL_FIELD_NAMES.ADDRESS_RES_3, CONSTANTS.LOGICAL_FIELD_NAMES.PINCODE_RES, CONSTANTS.LOGICAL_FIELD_NAMES.ALT_ADDRESS_SAME_AS_RES_ADDRESS_3],
                            newFields: [],
                            value: ''
                        })
                    );
                } else if(radioResidency.value !== CONSTANTS.LOV_DATA.CHINESE_MAINLAND && radioResidency.value !== CONSTANTS.LOV_DATA.HONG_KONG) {
                    dispatch(
                        stagesAction.removeAddToggleField({
                            removeFields: [CONSTANTS.LOGICAL_FIELD_NAMES.RES_DISTRICT_3,CONSTANTS.LOGICAL_FIELD_NAMES.RES_CITY_3,CONSTANTS.LOGICAL_FIELD_NAMES.RES_NAME_OF_STREET_1,CONSTANTS.LOGICAL_FIELD_NAMES.RES_BUILDING_ESTATE_1,CONSTANTS.LOGICAL_FIELD_NAMES.RES_ROOM_FLAT_1,CONSTANTS.LOGICAL_FIELD_NAMES.RES_NAME_OF_STREET_2,CONSTANTS.LOGICAL_FIELD_NAMES.RES_BUILDING_ESTATE_2,CONSTANTS.LOGICAL_FIELD_NAMES.RES_ROOM_FLAT_2,CONSTANTS.LOGICAL_FIELD_NAMES.POSTAL_CODE_1, CONSTANTS.LOGICAL_FIELD_NAMES.ALT_ADDRESS_SAME_AS_RES_ADDRESS_2],
                            newFields: [],
                            value: ''
                        })
                    );
                } else if(radioResidency.value === CONSTANTS.LOV_DATA.HONG_KONG) {
                    dispatch(
                        stagesAction.removeAddToggleField({
                            removeFields: [CONSTANTS.LOGICAL_FIELD_NAMES.RES_DISTRICT_3,CONSTANTS.LOGICAL_FIELD_NAMES.RES_CITY_3,CONSTANTS.LOGICAL_FIELD_NAMES.RES_NAME_OF_STREET_1,CONSTANTS.LOGICAL_FIELD_NAMES.RES_BUILDING_ESTATE_1,CONSTANTS.LOGICAL_FIELD_NAMES.RES_ROOM_FLAT_1,CONSTANTS.LOGICAL_FIELD_NAMES.RES_NAME_OF_STREET_2,CONSTANTS.LOGICAL_FIELD_NAMES.RES_BUILDING_ESTATE_2,CONSTANTS.LOGICAL_FIELD_NAMES.RES_ROOM_FLAT_2,CONSTANTS.LOGICAL_FIELD_NAMES.POSTAL_CODE_1, CONSTANTS.LOGICAL_FIELD_NAMES.ALT_ADDRESS_SAME_AS_RES_ADDRESS_2, CONSTANTS.LOGICAL_FIELD_NAMES.PINCODE_RES],
                            newFields: [],
                            value: ''
                        })
                    );
                }
            }
                if(radioResidency.logical_field_name === CONSTANTS.LOGICAL_FIELD_NAMES.RES_COUNTRY_2) {
                    if(radioResidency.value === CONSTANTS.LOV_DATA.CHINESE_MAINLAND) {
                        dispatch(
                            stagesAction.removeAddToggleField({
                                removeFields: [CONSTANTS.LOGICAL_FIELD_NAMES.STATE_MAILING_1, CONSTANTS.LOGICAL_FIELD_NAMES.CITY_MAILING_1,CONSTANTS.LOGICAL_FIELD_NAMES.ADDRESS_MAILING_1,CONSTANTS.LOGICAL_FIELD_NAMES.ADDRESS_MAILING_2,CONSTANTS.LOGICAL_FIELD_NAMES.ADDRESS_MAILING_3,CONSTANTS.LOGICAL_FIELD_NAMES.PINCODE_MAILING],
                                newFields: [],
                                value: ''
                            })
                        );
                    } else if(radioResidency.value !== CONSTANTS.LOV_DATA.CHINESE_MAINLAND && radioResidency.value !== CONSTANTS.LOV_DATA.HONG_KONG) {
                        dispatch(
                            stagesAction.removeAddToggleField({
                                removeFields: [CONSTANTS.LOGICAL_FIELD_NAMES.RES_DISTRICT_4, CONSTANTS.LOGICAL_FIELD_NAMES.RES_CITY_4, CONSTANTS.LOGICAL_FIELD_NAMES.RES_NAME_OF_STREET_3,CONSTANTS.LOGICAL_FIELD_NAMES.RES_BUILDING_ESTATE_3,CONSTANTS.LOGICAL_FIELD_NAMES.RES_ROOM_FLAT_3,CONSTANTS.LOGICAL_FIELD_NAMES.RES_NAME_OF_STREET_4,CONSTANTS.LOGICAL_FIELD_NAMES.RES_BUILDING_ESTATE_4,CONSTANTS.LOGICAL_FIELD_NAMES.RES_ROOM_FLAT_4, CONSTANTS.LOGICAL_FIELD_NAMES.POSTAL_CODE_2],
                                newFields: [],
                                value: ''
                            })
                        );
                    } else if(radioResidency.value === CONSTANTS.LOV_DATA.HONG_KONG) {
                        dispatch(
                            stagesAction.removeAddToggleField({
                                removeFields: [CONSTANTS.LOGICAL_FIELD_NAMES.RES_DISTRICT_4, CONSTANTS.LOGICAL_FIELD_NAMES.RES_CITY_4, CONSTANTS.LOGICAL_FIELD_NAMES.RES_NAME_OF_STREET_3,CONSTANTS.LOGICAL_FIELD_NAMES.RES_BUILDING_ESTATE_3,CONSTANTS.LOGICAL_FIELD_NAMES.RES_ROOM_FLAT_3,CONSTANTS.LOGICAL_FIELD_NAMES.RES_NAME_OF_STREET_4,CONSTANTS.LOGICAL_FIELD_NAMES.RES_BUILDING_ESTATE_4,CONSTANTS.LOGICAL_FIELD_NAMES.RES_ROOM_FLAT_4, CONSTANTS.LOGICAL_FIELD_NAMES.POSTAL_CODE_2, CONSTANTS.LOGICAL_FIELD_NAMES.PINCODE_MAILING],
                                newFields: [],
                                value: ''
                            })
                        );
                    }   
                }        
        }

        if (radioResidency) {

            if(radioResidency.logical_field_name === CONSTANTS.LOGICAL_FIELD_NAMES.FINANCIAL_INSTITUTION) {
                if(radioResidency.value === '999') {
                    showFields = [CONSTANTS.LOGICAL_FIELD_NAMES.FINANCIAL_INSTITUTION_1];
                    removeFields = [];
                }
                ssfStages = showFields;
                removeAddToggleFieldFn(showFields, removeFields)
            } else if(radioResidency.logical_field_name === CONSTANTS.LOGICAL_FIELD_NAMES.WORK_TYPE_2) {
                if(radioResidency.value === 'H' || radioResidency.value === 'T' || radioResidency.value === 'U' || radioResidency.value === 'R') {
                    showFields = [];
                    removeFields = [CONSTANTS.LOGICAL_FIELD_NAMES.NATURE_OF_EMPLOYER];
                } else {
                    showFields = [CONSTANTS.LOGICAL_FIELD_NAMES.NATURE_OF_EMPLOYER];
                    removeFields = [];
                }   
                ssfStages = showFields;
                removeAddToggleFieldFn(showFields, removeFields)
            } else if(radioResidency.logical_field_name === CONSTANTS.LOGICAL_FIELD_NAMES.RES_COUNTRY_1) {
                if(radioResidency.value === CONSTANTS.LOV_DATA.CHINESE_MAINLAND) {
                    showResFields = [CONSTANTS.LOGICAL_FIELD_NAMES.RES_COUNTRY_1,CONSTANTS.LOGICAL_FIELD_NAMES.RES_DISTRICT_3,CONSTANTS.LOGICAL_FIELD_NAMES.RES_NAME_OF_STREET_1,CONSTANTS.LOGICAL_FIELD_NAMES.RES_BUILDING_ESTATE_1,CONSTANTS.LOGICAL_FIELD_NAMES.RES_ROOM_FLAT_1, CONSTANTS.LOGICAL_FIELD_NAMES.PINYIN_RES ,CONSTANTS.LOGICAL_FIELD_NAMES.RES_NAME_OF_STREET_2,CONSTANTS.LOGICAL_FIELD_NAMES.RES_BUILDING_ESTATE_2,CONSTANTS.LOGICAL_FIELD_NAMES.RES_ROOM_FLAT_2, CONSTANTS.LOGICAL_FIELD_NAMES.POSTAL_CODE_1, CONSTANTS.LOGICAL_FIELD_NAMES.ALT_ADDRESS_SAME_AS_RES_ADDRESS_2];
                    removeResFields = [CONSTANTS.LOGICAL_FIELD_NAMES.RES_CITY_3, CONSTANTS.LOGICAL_FIELD_NAMES.STATE_RES_1, CONSTANTS.LOGICAL_FIELD_NAMES.CITY_RES_1,CONSTANTS.LOGICAL_FIELD_NAMES.ADDRESS_RES_1,CONSTANTS.LOGICAL_FIELD_NAMES.ADDRESS_RES_2,CONSTANTS.LOGICAL_FIELD_NAMES.ADDRESS_RES_3,CONSTANTS.LOGICAL_FIELD_NAMES.PINCODE_RES,CONSTANTS.LOGICAL_FIELD_NAMES.ALT_ADDRESS_SAME_AS_RES_ADDRESS_3];
                    dispatch(getLovData(CONSTANTS.LOGICAL_FIELD_NAMES.RES_DISTRICT_3))
                } else if(radioResidency.value !== CONSTANTS.LOV_DATA.CHINESE_MAINLAND && radioResidency.value !== CONSTANTS.LOV_DATA.HONG_KONG) {
                    showResFields = [CONSTANTS.LOGICAL_FIELD_NAMES.RES_COUNTRY_1, CONSTANTS.LOGICAL_FIELD_NAMES.STATE_RES_1, CONSTANTS.LOGICAL_FIELD_NAMES.CITY_RES_1,CONSTANTS.LOGICAL_FIELD_NAMES.ADDRESS_RES_1,CONSTANTS.LOGICAL_FIELD_NAMES.ADDRESS_RES_2,CONSTANTS.LOGICAL_FIELD_NAMES.ADDRESS_RES_3,CONSTANTS.LOGICAL_FIELD_NAMES.PINCODE_RES,CONSTANTS.LOGICAL_FIELD_NAMES.ALT_ADDRESS_SAME_AS_RES_ADDRESS_3];
                    
                    removeResFields = [CONSTANTS.LOGICAL_FIELD_NAMES.RES_DISTRICT_3,CONSTANTS.LOGICAL_FIELD_NAMES.RES_CITY_3,CONSTANTS.LOGICAL_FIELD_NAMES.RES_NAME_OF_STREET_1,CONSTANTS.LOGICAL_FIELD_NAMES.RES_BUILDING_ESTATE_1,CONSTANTS.LOGICAL_FIELD_NAMES.RES_ROOM_FLAT_1, CONSTANTS.LOGICAL_FIELD_NAMES.PINYIN_RES,CONSTANTS.LOGICAL_FIELD_NAMES.RES_NAME_OF_STREET_2,CONSTANTS.LOGICAL_FIELD_NAMES.RES_BUILDING_ESTATE_2,CONSTANTS.LOGICAL_FIELD_NAMES.RES_ROOM_FLAT_2, CONSTANTS.LOGICAL_FIELD_NAMES.POSTAL_CODE_1, CONSTANTS.LOGICAL_FIELD_NAMES.ALT_ADDRESS_SAME_AS_RES_ADDRESS_2,CONSTANTS.LOGICAL_FIELD_NAMES.RES_COUNTRY_2,CONSTANTS.LOGICAL_FIELD_NAMES.RES_DISTRICT_4,CONSTANTS.LOGICAL_FIELD_NAMES.RES_CITY_4, CONSTANTS.LOGICAL_FIELD_NAMES.RES_NAME_OF_STREET_3, CONSTANTS.LOGICAL_FIELD_NAMES.RES_ROOM_FLAT_3, CONSTANTS.LOGICAL_FIELD_NAMES.RES_BUILDING_ESTATE_3, CONSTANTS.LOGICAL_FIELD_NAMES.PINYIN_MAILING, CONSTANTS.LOGICAL_FIELD_NAMES.RES_ROOM_FLAT_4, CONSTANTS.LOGICAL_FIELD_NAMES.RES_NAME_OF_STREET_4, CONSTANTS.LOGICAL_FIELD_NAMES.RES_BUILDING_ESTATE_4, CONSTANTS.LOGICAL_FIELD_NAMES.POSTAL_CODE_2, CONSTANTS.LOGICAL_FIELD_NAMES.STATE_MAILING_1,CONSTANTS.LOGICAL_FIELD_NAMES.CITY_MAILING_1,CONSTANTS.LOGICAL_FIELD_NAMES.ADDRESS_MAILING_1, CONSTANTS.LOGICAL_FIELD_NAMES.ADDRESS_MAILING_2, CONSTANTS.LOGICAL_FIELD_NAMES.ADDRESS_MAILING_3, CONSTANTS.LOGICAL_FIELD_NAMES.PINCODE_MAILING];
                    dispatch(getLovData(CONSTANTS.LOGICAL_FIELD_NAMES.ALT_ADDRESS_SAME_AS_RES_ADDRESS_3))
                } else if(radioResidency.value === CONSTANTS.LOV_DATA.HONG_KONG) {
                    showResFields = [CONSTANTS.LOGICAL_FIELD_NAMES.RES_COUNTRY_1, CONSTANTS.LOGICAL_FIELD_NAMES.STATE_RES_1, CONSTANTS.LOGICAL_FIELD_NAMES.CITY_RES_1,CONSTANTS.LOGICAL_FIELD_NAMES.ADDRESS_RES_1,CONSTANTS.LOGICAL_FIELD_NAMES.ADDRESS_RES_2,CONSTANTS.LOGICAL_FIELD_NAMES.ADDRESS_RES_3,CONSTANTS.LOGICAL_FIELD_NAMES.ALT_ADDRESS_SAME_AS_RES_ADDRESS_3];
                    
                    removeResFields = [CONSTANTS.LOGICAL_FIELD_NAMES.RES_DISTRICT_3,CONSTANTS.LOGICAL_FIELD_NAMES.RES_CITY_3,CONSTANTS.LOGICAL_FIELD_NAMES.RES_NAME_OF_STREET_1,CONSTANTS.LOGICAL_FIELD_NAMES.RES_BUILDING_ESTATE_1,CONSTANTS.LOGICAL_FIELD_NAMES.RES_ROOM_FLAT_1, CONSTANTS.LOGICAL_FIELD_NAMES.PINYIN_RES,CONSTANTS.LOGICAL_FIELD_NAMES.RES_NAME_OF_STREET_2,CONSTANTS.LOGICAL_FIELD_NAMES.RES_BUILDING_ESTATE_2,CONSTANTS.LOGICAL_FIELD_NAMES.RES_ROOM_FLAT_2, CONSTANTS.LOGICAL_FIELD_NAMES.POSTAL_CODE_1, CONSTANTS.LOGICAL_FIELD_NAMES.ALT_ADDRESS_SAME_AS_RES_ADDRESS_2,CONSTANTS.LOGICAL_FIELD_NAMES.RES_COUNTRY_2,CONSTANTS.LOGICAL_FIELD_NAMES.RES_DISTRICT_4,CONSTANTS.LOGICAL_FIELD_NAMES.RES_CITY_4, CONSTANTS.LOGICAL_FIELD_NAMES.RES_NAME_OF_STREET_3, CONSTANTS.LOGICAL_FIELD_NAMES.RES_ROOM_FLAT_3, CONSTANTS.LOGICAL_FIELD_NAMES.RES_BUILDING_ESTATE_3, CONSTANTS.LOGICAL_FIELD_NAMES.PINYIN_MAILING, CONSTANTS.LOGICAL_FIELD_NAMES.RES_ROOM_FLAT_4, CONSTANTS.LOGICAL_FIELD_NAMES.RES_NAME_OF_STREET_4, CONSTANTS.LOGICAL_FIELD_NAMES.RES_BUILDING_ESTATE_4, CONSTANTS.LOGICAL_FIELD_NAMES.POSTAL_CODE_2, CONSTANTS.LOGICAL_FIELD_NAMES.STATE_MAILING_1,CONSTANTS.LOGICAL_FIELD_NAMES.CITY_MAILING_1,CONSTANTS.LOGICAL_FIELD_NAMES.ADDRESS_MAILING_1, CONSTANTS.LOGICAL_FIELD_NAMES.ADDRESS_MAILING_2, CONSTANTS.LOGICAL_FIELD_NAMES.ADDRESS_MAILING_3, CONSTANTS.LOGICAL_FIELD_NAMES.PINCODE_MAILING, CONSTANTS.LOGICAL_FIELD_NAMES.PINCODE_RES];
                    dispatch(getLovData(CONSTANTS.LOGICAL_FIELD_NAMES.ALT_ADDRESS_SAME_AS_RES_ADDRESS_3))
                }
                ssfStages = showResFields
                updateDynamicFields(radioResidency)
            } else if(radioResidency.logical_field_name === CONSTANTS.LOGICAL_FIELD_NAMES.RES_DISTRICT_3 && !removeList) {
                showResFields = [CONSTANTS.LOGICAL_FIELD_NAMES.RES_COUNTRY_1,CONSTANTS.LOGICAL_FIELD_NAMES.RES_DISTRICT_3,CONSTANTS.LOGICAL_FIELD_NAMES.RES_CITY_3,CONSTANTS.LOGICAL_FIELD_NAMES.RES_NAME_OF_STREET_1,CONSTANTS.LOGICAL_FIELD_NAMES.RES_BUILDING_ESTATE_1,CONSTANTS.LOGICAL_FIELD_NAMES.RES_ROOM_FLAT_1, CONSTANTS.LOGICAL_FIELD_NAMES.PINYIN_RES,CONSTANTS.LOGICAL_FIELD_NAMES.RES_NAME_OF_STREET_2,CONSTANTS.LOGICAL_FIELD_NAMES.RES_BUILDING_ESTATE_2,CONSTANTS.LOGICAL_FIELD_NAMES.RES_ROOM_FLAT_2,CONSTANTS.LOGICAL_FIELD_NAMES.POSTAL_CODE_1, CONSTANTS.LOGICAL_FIELD_NAMES.ALT_ADDRESS_SAME_AS_RES_ADDRESS_2];
                removeResFields = [CONSTANTS.LOGICAL_FIELD_NAMES.STATE_RES_1, CONSTANTS.LOGICAL_FIELD_NAMES.CITY_RES_1,CONSTANTS.LOGICAL_FIELD_NAMES.ADDRESS_RES_1,CONSTANTS.LOGICAL_FIELD_NAMES.ADDRESS_RES_2,CONSTANTS.LOGICAL_FIELD_NAMES.ADDRESS_RES_3,CONSTANTS.LOGICAL_FIELD_NAMES.PINCODE_RES,CONSTANTS.LOGICAL_FIELD_NAMES.ALT_ADDRESS_SAME_AS_RES_ADDRESS_3];
                dispatch(getLovData(CONSTANTS.LOGICAL_FIELD_NAMES.RES_CITY_3, '', radioResidency.value))

                ssfStages = showResFields;
                updateDynamicFields(radioResidency)
            } else if(radioResidency.logical_field_name === CONSTANTS.LOGICAL_FIELD_NAMES.RES_DISTRICT_3 && removeList) {
                showResFields = [CONSTANTS.LOGICAL_FIELD_NAMES.RES_COUNTRY_1,CONSTANTS.LOGICAL_FIELD_NAMES.RES_DISTRICT_3,CONSTANTS.LOGICAL_FIELD_NAMES.RES_NAME_OF_STREET_1,CONSTANTS.LOGICAL_FIELD_NAMES.RES_BUILDING_ESTATE_1,CONSTANTS.LOGICAL_FIELD_NAMES.RES_ROOM_FLAT_1, CONSTANTS.LOGICAL_FIELD_NAMES.PINYIN_RES,CONSTANTS.LOGICAL_FIELD_NAMES.RES_NAME_OF_STREET_2,CONSTANTS.LOGICAL_FIELD_NAMES.RES_BUILDING_ESTATE_2,CONSTANTS.LOGICAL_FIELD_NAMES.RES_ROOM_FLAT_2,CONSTANTS.LOGICAL_FIELD_NAMES.POSTAL_CODE_1, CONSTANTS.LOGICAL_FIELD_NAMES.ALT_ADDRESS_SAME_AS_RES_ADDRESS_2];
                removeResFields = [CONSTANTS.LOGICAL_FIELD_NAMES.STATE_RES_1, CONSTANTS.LOGICAL_FIELD_NAMES.CITY_RES_1,CONSTANTS.LOGICAL_FIELD_NAMES.ADDRESS_RES_1,CONSTANTS.LOGICAL_FIELD_NAMES.ADDRESS_RES_2,CONSTANTS.LOGICAL_FIELD_NAMES.ADDRESS_RES_3,CONSTANTS.LOGICAL_FIELD_NAMES.PINCODE_RES,CONSTANTS.LOGICAL_FIELD_NAMES.ALT_ADDRESS_SAME_AS_RES_ADDRESS_3, CONSTANTS.LOGICAL_FIELD_NAMES.RES_CITY_3];
                
                ssfStages = showResFields;
                updateDynamicFields(radioResidency)
            }
            if(radioResidency.logical_field_name === CONSTANTS.LOGICAL_FIELD_NAMES.RES_COUNTRY_2) {
                if(radioResidency.value === CONSTANTS.LOV_DATA.CHINESE_MAINLAND) {
                    showMailFields = [CONSTANTS.LOGICAL_FIELD_NAMES.RES_COUNTRY_2, CONSTANTS.LOGICAL_FIELD_NAMES.RES_DISTRICT_4, CONSTANTS.LOGICAL_FIELD_NAMES.RES_NAME_OF_STREET_3,CONSTANTS.LOGICAL_FIELD_NAMES.RES_BUILDING_ESTATE_3,CONSTANTS.LOGICAL_FIELD_NAMES.RES_ROOM_FLAT_3,CONSTANTS.LOGICAL_FIELD_NAMES.RES_NAME_OF_STREET_4,CONSTANTS.LOGICAL_FIELD_NAMES.RES_BUILDING_ESTATE_4,CONSTANTS.LOGICAL_FIELD_NAMES.RES_ROOM_FLAT_4,CONSTANTS.LOGICAL_FIELD_NAMES.PINYIN_MAILING, CONSTANTS.LOGICAL_FIELD_NAMES.POSTAL_CODE_2];
                    removeMailFields = [CONSTANTS.LOGICAL_FIELD_NAMES.RES_CITY_4, CONSTANTS.LOGICAL_FIELD_NAMES.STATE_MAILING_1, CONSTANTS.LOGICAL_FIELD_NAMES.CITY_MAILING_1,CONSTANTS.LOGICAL_FIELD_NAMES.ADDRESS_MAILING_1,CONSTANTS.LOGICAL_FIELD_NAMES.ADDRESS_MAILING_2,CONSTANTS.LOGICAL_FIELD_NAMES.ADDRESS_MAILING_3,CONSTANTS.LOGICAL_FIELD_NAMES.PINCODE_MAILING];
                    dispatch(getLovData(CONSTANTS.LOGICAL_FIELD_NAMES.RES_DISTRICT_4))
                } else if(radioResidency.value !== CONSTANTS.LOV_DATA.CHINESE_MAINLAND && radioResidency.value !== CONSTANTS.LOV_DATA.HONG_KONG) {
                    showMailFields = [CONSTANTS.LOGICAL_FIELD_NAMES.RES_COUNTRY_2, CONSTANTS.LOGICAL_FIELD_NAMES.STATE_MAILING_1, CONSTANTS.LOGICAL_FIELD_NAMES.CITY_MAILING_1,CONSTANTS.LOGICAL_FIELD_NAMES.ADDRESS_MAILING_1,CONSTANTS.LOGICAL_FIELD_NAMES.ADDRESS_MAILING_2,CONSTANTS.LOGICAL_FIELD_NAMES.ADDRESS_MAILING_3,CONSTANTS.LOGICAL_FIELD_NAMES.PINCODE_MAILING];
                    removeMailFields = [CONSTANTS.LOGICAL_FIELD_NAMES.RES_DISTRICT_4, CONSTANTS.LOGICAL_FIELD_NAMES.RES_CITY_4, CONSTANTS.LOGICAL_FIELD_NAMES.RES_NAME_OF_STREET_3,CONSTANTS.LOGICAL_FIELD_NAMES.RES_BUILDING_ESTATE_3,CONSTANTS.LOGICAL_FIELD_NAMES.RES_ROOM_FLAT_3,CONSTANTS.LOGICAL_FIELD_NAMES.RES_NAME_OF_STREET_4,CONSTANTS.LOGICAL_FIELD_NAMES.RES_BUILDING_ESTATE_4,CONSTANTS.LOGICAL_FIELD_NAMES.RES_ROOM_FLAT_4,CONSTANTS.LOGICAL_FIELD_NAMES.PINYIN_MAILING, CONSTANTS.LOGICAL_FIELD_NAMES.POSTAL_CODE_2];
                } else if(radioResidency.value === CONSTANTS.LOV_DATA.HONG_KONG) {
                    showMailFields = [CONSTANTS.LOGICAL_FIELD_NAMES.RES_COUNTRY_2, CONSTANTS.LOGICAL_FIELD_NAMES.STATE_MAILING_1, CONSTANTS.LOGICAL_FIELD_NAMES.CITY_MAILING_1,CONSTANTS.LOGICAL_FIELD_NAMES.ADDRESS_MAILING_1,CONSTANTS.LOGICAL_FIELD_NAMES.ADDRESS_MAILING_2,CONSTANTS.LOGICAL_FIELD_NAMES.ADDRESS_MAILING_3];
                    removeMailFields = [CONSTANTS.LOGICAL_FIELD_NAMES.RES_DISTRICT_4, CONSTANTS.LOGICAL_FIELD_NAMES.RES_CITY_4, CONSTANTS.LOGICAL_FIELD_NAMES.RES_NAME_OF_STREET_3,CONSTANTS.LOGICAL_FIELD_NAMES.RES_BUILDING_ESTATE_3,CONSTANTS.LOGICAL_FIELD_NAMES.RES_ROOM_FLAT_3,CONSTANTS.LOGICAL_FIELD_NAMES.RES_NAME_OF_STREET_4,CONSTANTS.LOGICAL_FIELD_NAMES.RES_BUILDING_ESTATE_4,CONSTANTS.LOGICAL_FIELD_NAMES.RES_ROOM_FLAT_4,CONSTANTS.LOGICAL_FIELD_NAMES.PINYIN_MAILING, CONSTANTS.LOGICAL_FIELD_NAMES.POSTAL_CODE_2, CONSTANTS.LOGICAL_FIELD_NAMES.PINCODE_MAILING];
                }
                ssfStages = showMailFields
                updateDynamicFields(radioResidency)
                
            } else if(radioResidency.logical_field_name === CONSTANTS.LOGICAL_FIELD_NAMES.RES_DISTRICT_4 && !removeList) {
                showMailFields = [CONSTANTS.LOGICAL_FIELD_NAMES.RES_COUNTRY_2, CONSTANTS.LOGICAL_FIELD_NAMES.RES_DISTRICT_4, CONSTANTS.LOGICAL_FIELD_NAMES.RES_CITY_4, CONSTANTS.LOGICAL_FIELD_NAMES.RES_NAME_OF_STREET_3,CONSTANTS.LOGICAL_FIELD_NAMES.RES_BUILDING_ESTATE_3,CONSTANTS.LOGICAL_FIELD_NAMES.RES_ROOM_FLAT_3,CONSTANTS.LOGICAL_FIELD_NAMES.RES_NAME_OF_STREET_4,CONSTANTS.LOGICAL_FIELD_NAMES.RES_BUILDING_ESTATE_4,CONSTANTS.LOGICAL_FIELD_NAMES.RES_ROOM_FLAT_4,CONSTANTS.LOGICAL_FIELD_NAMES.PINYIN_MAILING, CONSTANTS.LOGICAL_FIELD_NAMES.POSTAL_CODE_2];
                removeMailFields = [CONSTANTS.LOGICAL_FIELD_NAMES.STATE_MAILING_1, CONSTANTS.LOGICAL_FIELD_NAMES.CITY_MAILING_1,CONSTANTS.LOGICAL_FIELD_NAMES.ADDRESS_MAILING_1,CONSTANTS.LOGICAL_FIELD_NAMES.ADDRESS_MAILING_2,CONSTANTS.LOGICAL_FIELD_NAMES.ADDRESS_MAILING_3,CONSTANTS.LOGICAL_FIELD_NAMES.PINCODE_MAILING];
                dispatch(getLovData(CONSTANTS.LOGICAL_FIELD_NAMES.RES_CITY_4, '', radioResidency.value))

                ssfStages = showMailFields;
                updateDynamicFields(radioResidency)
            } else if(radioResidency.logical_field_name === CONSTANTS.LOGICAL_FIELD_NAMES.RES_DISTRICT_4 && removeList) {
                showMailFields = [CONSTANTS.LOGICAL_FIELD_NAMES.RES_COUNTRY_2, CONSTANTS.LOGICAL_FIELD_NAMES.RES_DISTRICT_4, CONSTANTS.LOGICAL_FIELD_NAMES.RES_NAME_OF_STREET_3,CONSTANTS.LOGICAL_FIELD_NAMES.RES_BUILDING_ESTATE_3,CONSTANTS.LOGICAL_FIELD_NAMES.RES_ROOM_FLAT_3,CONSTANTS.LOGICAL_FIELD_NAMES.RES_NAME_OF_STREET_4,CONSTANTS.LOGICAL_FIELD_NAMES.RES_BUILDING_ESTATE_4,CONSTANTS.LOGICAL_FIELD_NAMES.RES_ROOM_FLAT_4,CONSTANTS.LOGICAL_FIELD_NAMES.PINYIN_MAILING, CONSTANTS.LOGICAL_FIELD_NAMES.POSTAL_CODE_2];
                removeMailFields = [CONSTANTS.LOGICAL_FIELD_NAMES.STATE_MAILING_1, CONSTANTS.LOGICAL_FIELD_NAMES.CITY_MAILING_1,CONSTANTS.LOGICAL_FIELD_NAMES.ADDRESS_MAILING_1,CONSTANTS.LOGICAL_FIELD_NAMES.ADDRESS_MAILING_2,CONSTANTS.LOGICAL_FIELD_NAMES.ADDRESS_MAILING_3,CONSTANTS.LOGICAL_FIELD_NAMES.PINCODE_MAILING, CONSTANTS.LOGICAL_FIELD_NAMES.RES_CITY_4];

                ssfStages = showMailFields;
                updateDynamicFields(radioResidency)
            }
        }
        if (ssfStages && fields) {
            if(getStages[0].stageId === 'bd-3') {
                dispatch(fieldErrorAction.getMandatoryFields(ssfStages));
            }
            const stageComponents = fields.filter((field: KeyWithAnyModel) =>
                ssfStages!.includes(field.logical_field_name)
            );
            if (getStages[0].stageId === 'bd-5') {
                dispatch(stagesAction.updateParentChildToggle({
                    deleteSelectFields: removeResFields.concat(removeMailFields),
                    addSelectFields: Array.from(new Set((parentChildToggleSelector.addSelectFields.concat(showResFields)).concat(showMailFields))),
                    // addSelectFields: Array.from(new Set(showResFields.concat(showMailFields))),
                    resFields: Array.from(new Set(showResFields.concat(showMailFields))),
                    selectFields: stageComponents
                }))  
            } else if(getStages[0].stageId === 'bd-4') {
                dispatch(stagesAction.updateNatureOfEmployeeField({
                    addFields: showFields,
                    removeFields: removeFields
                }))
            }         
            return stageComponents;
        }
        return null;
    }
}
