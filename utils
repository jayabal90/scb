import { FieldsetModel, KeyWithAnyModel } from '../../utils/model/common-model';

const rulesUtils = (props: KeyWithAnyModel, validationObj: any) => {
    const result = props.map((element: Array<FieldsetModel>) => {
        return element && element.map((res: FieldsetModel) => {
            const eFields = res.fields.map((res: KeyWithAnyModel) => {
                console.log(res,"stahe 1")
              //  console.log(validationObj.hidden[0].includes(res.logical_field_name))
                return {
                    ...res,
                    editable: validationObj.nonEditable[0] && validationObj.nonEditable[0].includes(res.logical_field_name) ? true : false
                }
            })
            console.log(eFields,"efields 2", {...res})
            const default_visibility_no_field=[
                "monthly_installment_mortgage_payment",
                "total_outstanding_other_loan_amount",
                "total_outstanding_other_monthly_payment",
                "direct_marketing_opt_out",
                "oth_bank_name",
                "oth_bank_number"
            ]
            
                 eFields.map((subElement: KeyWithAnyModel) =>{
                //default_visibility_no_field make null
                if(default_visibility_no_field.indexOf(subElement.logical_field_name)>-1){
                    subElement.default_visibility=null;
                }
                const hiddenFields = ["place_of_birth","purpose_of_account","temp_cli_label","enotice_label","credit_limit_extension", "estatement","note_credit","estatement_fee"];
                //hidden field make default_visibility No
                if(hiddenFields.indexOf(subElement.logical_field_name)>-1){
                    subElement.default_visibility='No';

                }
            });
            const vFields = eFields.filter((subElement: KeyWithAnyModel) => (subElement.default_visibility !== 'No'));
            // const vFields = eFields.filter((subElement: KeyWithAnyModel) =>!(validationObj.hidden.length > 0 && validationObj.hidden[0].includes(subElement.logical_field_name) && (subElement.default_visibility !== 'No'));
            console.log(vFields,"stahe 2", {...res})
            return { ...res, fields: vFields }
        })
    })
    return result[0]
}

export default rulesUtils
